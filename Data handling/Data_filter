import pandas as pd

# 1. Load your curated energy HS codes
# Assume your file has at least one column called "hs_code"
energy_codes = pd.read_csv("Surefire_product_codes_HS22.csv")

# Extract the list of codes (make sure they are the same type as in BACI)
energy_code_list = energy_codes["hs_code"].astype(str).tolist()

# 2. Load the full BACI dataset
# BACI typically has columns like: year, exporter, importer, product_code, value
baci = pd.read_csv("baci_full.csv")

# Ensure product codes are strings for matching
baci["product_code"] = baci["product_code"].astype(str)

# 3. Filter BACI to only your energy codes
baci_energy = baci[baci["product_code"].isin(energy_code_list)]

# 4. Save the filtered dataset
baci_energy.to_csv("baci_energy_subset.csv", index=False)

print("Filtered dataset saved with", len(baci_energy), "rows.")
